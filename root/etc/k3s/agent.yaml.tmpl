{{- if .is_worker }}
# K3s agent configuration for worker nodes
token-file: /var/lib/rancher/k3s/server/token
server: https://{{ .network.virtual_ip }}:6443

# Node configuration
node-ip: {{ .node_ip }}
node-external-ip: {{ .node_ip }}

# Kubelet configuration
kubelet-arg:
  - "node-ip={{ .node_ip }}"
  - "cluster-dns={{ .k3s.cluster_dns }}"
  - "max-pods=250"

# Node labels
node-label:
  - "node.kubernetes.io/instance-type=raspberry-pi-5"
  - "storage.kubernetes.io/nvme=true"

# Node taints (if needed for specialized workloads)
# node-taint:
#   - "workload=storage:NoSchedule"

# CNI configuration (Cilium will be used)
flannel-backend: none
disable-network-policy: true
{{- end }}